\documentclass[a4paper,article]{article}

\usepackage[utf-8]{inputenc}
\usepackage[russian]{babel}

\usepackage{amsmath,amssymb}
\usepackage{graphicx}

\begin{document}
\tableofcontents

{\bf \Large О применении метода конечных элементов для решения
  уравнений в частных производных на гладких многообразиях.}

\begin{center}
Озерицкий А.В., Иванчиков А.А.
\end{center}

{\small
\noindent {\bf 1. Аннотация.}
В работе рассмотрено применение метода конечных элементов для
уравнений в частных производных, заданных на гладких многообразиях.
Рассмотренный подход позволяет решать уравнения в частных производных
на произвольных гладких многообразиях. 
В качестве примера рассматривается решение уравнения лапласа на сфере.}
\end{abstract}
Ключевые слова: конечные элементы, численный алгоритм, уравнение
Лапласа.

\section{О методе конечных элементов}

\section{Уравнение Лапласа на сфере}
Рассмотрим уравнение Лапласа на сфере:
\begin{equation*}
\frac{1}{cos\phi}\frac{\partial}{\partial\phi}
cos\phi\frac{\partial}{\partial\phi} u(\phi, \lambda) +
\frac{1}{cos^2\phi}\frac{\partial^2}
{\lambda^2} u(\phi, \lambda) = f(\phi, \lambda)
\end{equation*}
координаты на сфере $(\phi,\lambda)$ заданы как в географии:
$\lambda \in [0,2\pi]$ - долгота. $\phi \in [-\pi/2,\pi/2]$ - широта.

\begin{equation}\label{sphere_coord}
\begin{split}
x = cos \lambda cos \phi, \\
y = cos \lambda sin \phi, \\
z = sin \phi. 
\end{split}
\end{equation}

Так как уравнение Лапласа на сфере не имеет единственного решения, то
чтобы избавиться от неоднозначности зададим краевое условие в
произвольной точке, например в южном полюсе:
\begin{equation*}
\begin{split}
u_{(-\frac{\pi}{2},0)}=u_0
\end{split}
\end{equation*} 

На сфере есть две особенности: южный полюс и северный
полюс. Рассмотрим северный полюс, в южном полюсе ситуация будет
аналогичная. Допустим, что полюс не содержит точку триангуляции, тогда
существует треугольник, которому принадлежит точка триангуляции. Чтобы
посчитать интеграл по этому треугольнику необходимо его разбить на
треугольники, которые содержат полюс (см. рис()). Будем считать,
что триангуляция уже содержит точку полюса. Рассмотрим треугольник,
содержащий полюс в качестве вершины. Заметим, что в локальных
координатах на сфере этот треугольник будет являться не треугольником,
а прямоугольником. Можно конечно модифицировать наш алгоритм, который
будет интегралы именно по этим треугольникам считать как интегралы по
прямоугольникам, но тогда это будет частный алгоритм, который будет
работать только на сфере. 

Выделим две области на сфере, которые содержат северный и южный
полюс. Например можно взять области с $z<-0.9$ и $z>0.9$. Введем в
этих областях другие локальные системы координат. Для этого повернем сферу
вокруг оси $X$ на угол $-90$ градусов, что эквивалентно замене координат:
\begin{equation*}
\begin{split}
x' = x,\\
y' = -z,\\
y' = y,
\end{split}
\end{equation*}
где $(x',y',z')$ - новые координаты. Введем в области $z>0.9$ систему
координат по формулам~\ref{sphere_coord} для $(x',y',z')$.
В области $z<-0.9$ введем новые координаты аналогично, только сферу
повернем покруг оси $X$ на угол $90$ градусов.
Заметим, что в новых координатах области $z<-0.9$ и $z>0.9$ не
содержат полюсов.

Осталась область в центре сферы. Заметим, что область содержит
циклическую координату $\lambda$. Если треугольник в этой области
пересекает прямую $\lambda=0$, то из-за цикличности интеграл по этому
треугольнику придется считать особым образом. Поэтому, чтобы
избавиться от цикличности разобъем центральную область на две части и
введем в каждой подобласти свои координаты с отличием на $\pi$ по
компонете $\lambda$.

В итоге мы разбили сферу на четыре области со своей локальной системой
координат (см. рис ()). Каждая область не содержит ни полюсов ни
циклических координат. 

\subsection{Построение сетки}
Возьмем икосаэдр. Каждое ребро икосаэдра разделим пополам и
получившуюся точку спроектируем на сферу. С получившимся
многогранником можно проделать ту же самую процедуру. На каждом шаге
алгоритма шаг сетки уменьшается вдвое. 

\includegraphics[scale=0.5]{icosahedron.eps}

\subsection{Формулировка численной задачи}
Численная задача:
\begin{equation*}
\begin{split}
(\frac{1}{cos\psi}\frac{\partial}{\partial \phi} \phi_i, cos\phi \frac{\partial}{\partial \phi} \phi_j)
+(\frac{1}{cos\psi}\frac{\partial}{\partial \lambda}\phi_i, \frac{1}{cos\psi}\frac{\partial}{\partial \lambda}\phi_j ) = -(f, \phi_j), \forall j, \forall i, \text{ для внутренних узлов } \\
u = u_0 \phi_i, \text { для граничных узлов, }
\end{split}
\end{equation*}
где $\phi_i$, $\phi_j$ - базисные функции.

Скалярное произведение:
\begin{equation*}
(u, v) = \int_\Omega u v ds = \int\int_\Omega u v cos(\phi)d\lambda d\phi.
\end{equation*}

Система уравнений:
\begin{equation*}
\sum_j x_j \sum_{k: \{j\in\bigtriangleup_k, i\in\bigtriangleup_k\}}\int_{\bigtriangleup_k}\frac{1}{cos\psi}(\frac{\partial}{\partial \phi} \phi_i) cos\phi (\frac{\partial}{\partial \phi} \phi_j)+\frac{1}{cos^2\psi}\phi_i\phi_j ds = \sum_{k:\{i\in\bigtriangleup_k\}}\int_{\bigtriangleup_k}f \phi_j ds,
\end{equation*}
где
\begin{equation*}
u(\phi,\lambda)=\sum_i x_i \phi_i(\phi, \lambda),\\
f(\phi,\lambda)=\sum_i f_i \phi_i(\phi, \lambda).
\end{equation*}

\subsection{Базисные  функции}
Используются линейные базисные функции. Каждая базисная функция $\phi_i$ равна единице в узле с номером $i$ и нулю в остальных узлах. Функция отлична от нуля на треугольниках, содержащих узел с номером $i$.
Три базисные функции на треугольнике с координатами $x_1,x_2,x_3, y_1,y_2,y_3$:
\begin{equation*}
\begin{split}
\psi_1=(x-x_2)(y_3-y_2)-(y-y_2)(x_3-x2),\\
\psi_2=(x-x_1)(y_3-y_1)-(y-y_1)(x_3-x1),\\
\psi_3=(x-x_1)(y_2-y_1)-(y-y_1)(x_2-x1).
\end{split}
\end{equation*} 
\begin{equation*}
\phi_i=\frac{\psi_i}{\psi_i(x_i,y_i)}
\end{equation*}

см. файл mke.cpp: функции elem1, elem1\_inner.
Каждая функция представляется полиномом от двух переменных $(x,y)$.

см. файл polynom.h: класс Polynom содержит вектор коэффициэнтов, доступны все операции с полиномами. Поддерживаются только полином от $(x)$ и от $(x,y)$.

\subsubsection{Интегрирование  полиномов} 
mke.cpp: функция integrate - вычисление интегралов вида:
\begin{equation*}
\begin{split}
\int_\bigtriangleup P(x,y) dx dy,\\
\int_\bigtriangleup P(x,y) cos(x) dx dy,\\
\int_\bigtriangleup P(x,y) / cos(x) dx dy.
\end{split}
\end{equation*}

util.cpp: функция trapezoid\_integrate - вычисление интегралов вида:
\begin{equation*}
\begin{split}
\int_\bigtriangleup x^k y^n dx dy\text { - считается аналитически }, \\
\int_\bigtriangleup x^k y^n cos x dx dy\text{ - используется квадратура Гаусса-Кронрода 15 } ,\\
\int_\bigtriangleup \frac{x^k y^n}{cos x} dx dy\text{ - используется квадратура Гаусса-Кронрода 15 }.
\end{split}
\end{equation*}

\section{Сборка и запуск}
\begin{verbatim}
cmake -DCMAKE_BUILD_TYPE=Release
make
./sphere --type test --iters 5 --coord local > mesh.txt
./test_slaplace mesh.txt
\end{verbatim}

\begin{thebibliography}{999}
\bibitem{bogach3} Богачев К. Ю., {\it  Практикум на ЭВМ.  Методы
    приближения функций, 3-е изд.}// M.:Изд-во
  механико-математического факультета МГУ. 2002.

\end{thebibliography}

\end{document}

