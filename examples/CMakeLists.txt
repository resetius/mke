project(phelm_examples CXX C)

set(EXECUTABLE_OUTPUT_PATH "../bin")
include_directories(../src ../auxiliary)
link_directories(../lib)

add_executable(test_laplace test_laplace.cpp)
add_executable(test_system_laplace test_system_laplace.cpp)
add_executable(test_slaplace test_slaplace.cpp)
add_executable(test_schafe test_schafe.cpp)
add_executable(test_barvortex test_barvortex.cpp)
add_executable(test_baroclin test_baroclin.cpp)
add_executable(test_chafe test_chafe.cpp)

target_link_libraries(test_laplace phelm phelm_aux ${UMFPACK})
target_link_libraries(test_system_laplace phelm phelm_aux ${UMFPACK})
target_link_libraries(test_slaplace phelm_aux phelm ${UMFPACK})
target_link_libraries(test_schafe phelm_aux phelm ${UMFPACK})
target_link_libraries(test_barvortex phelm_aux phelm ${UMFPACK})
target_link_libraries(test_baroclin phelm_aux phelm ${UMFPACK})
target_link_libraries(test_chafe phelm_aux phelm ${UMFPACK})

if (OPENMP_FOUND)
set_target_properties(test_laplace PROPERTIES LINK_FLAGS ${OpenMP_C_FLAGS})
set_target_properties(test_system_laplace PROPERTIES LINK_FLAGS ${OpenMP_C_FLAGS})
set_target_properties(test_slaplace PROPERTIES LINK_FLAGS ${OpenMP_C_FLAGS})
set_target_properties(test_schafe PROPERTIES LINK_FLAGS ${OpenMP_C_FLAGS})
set_target_properties(test_barvortex PROPERTIES LINK_FLAGS ${OpenMP_C_FLAGS})
set_target_properties(test_baroclin PROPERTIES LINK_FLAGS ${OpenMP_C_FLAGS})
set_target_properties(test_chafe PROPERTIES LINK_FLAGS ${OpenMP_C_FLAGS})
endif (OPENMP_FOUND)

if (CUDA_FOUND)
	cuda_add_executable(test_laplace_cu test_laplace.cpp)
	target_link_libraries(test_laplace_cu phelm_cu phelm_aux_cu ${UMFPACK})
	cuda_add_cublas_to_target(test_laplace_cu)
	set_target_properties(test_laplace_cu PROPERTIES COMPILE_FLAGS "-DGPGPU")

	cuda_add_executable(test_slaplace_cu test_slaplace.cpp)
	target_link_libraries(test_slaplace_cu phelm_cu phelm_aux_cu ${UMFPACK})
	cuda_add_cublas_to_target(test_slaplace_cu)
	set_target_properties(test_slaplace_cu PROPERTIES COMPILE_FLAGS "-DGPGPU")

	cuda_add_executable(test_chafe_cu test_chafe.cpp)
	target_link_libraries(test_chafe_cu phelm_cu phelm_aux_cu ${UMFPACK})
	cuda_add_cublas_to_target(test_chafe_cu)
	set_target_properties(test_chafe_cu PROPERTIES COMPILE_FLAGS "-DGPGPU")

	cuda_add_executable(test_schafe_cu test_schafe.cpp)
	target_link_libraries(test_schafe_cu phelm_cu phelm_aux_cu ${UMFPACK})
	cuda_add_cublas_to_target(test_schafe_cu)
	set_target_properties(test_schafe_cu PROPERTIES COMPILE_FLAGS "-DGPGPU")

	if (OPENMP_FOUND)
		set_target_properties(test_laplace_cu PROPERTIES LINK_FLAGS ${OpenMP_C_FLAGS})
		set_target_properties(test_slaplace_cu PROPERTIES LINK_FLAGS ${OpenMP_C_FLAGS})
		set_target_properties(test_chafe_cu PROPERTIES LINK_FLAGS ${OpenMP_C_FLAGS})
		set_target_properties(test_schafe_cu PROPERTIES LINK_FLAGS ${OpenMP_C_FLAGS})
	endif (OPENMP_FOUND)
endif (CUDA_FOUND)

