%{
#include "netcdf_cmd.h"
extern int yyerror(CMD_Parser * ptr, const char *s);
extern int yylex(CMD_Parser * ptr);
%}
%union {
	int num;
	char * str;
}
%parse-param { CMD_Parser * ptr }
%lex-param { CMD_Parser * ptr }
%token HELP
%token INFO
%token <num> NUMBER
%token <str> STR
%token FLE
%token DIM
%token VAR
%token ATT
%%

grp: hlp
	| info
	| file
	| grp grp
	;

hlp: HELP { ptr->help(); }
	;

file: FLE STR { ptr->open($2); }
	;

info: INFO  { ptr->info(); }
	| INFO DIM NUMBER { ptr->info_dim($3); }
	| INFO DIM STR    { ptr->info_dim($3); }
	| INFO VAR NUMBER { ptr->info_var($3); }
	| INFO VAR STR    { ptr->info_var($3); }
	| INFO ATT NUMBER { ptr->info_att($3); }
	| INFO ATT STR    { ptr->info_att($3); }
	;
%%

int yyerror(CMD_Parser * ptr, const char * s)
{
	fprintf(stderr, "cmd syntax error\n");
	ptr->help();
	exit(-1);
	return 0;
}

int yylex(CMD_Parser * ptr)
{
	return ptr->next();
}

